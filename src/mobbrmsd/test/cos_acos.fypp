#:set cos1_sqrt_part_x = [ &
&   "0.0000000000000000E+00", "1.0000000000000000E-00", &
& ]
#:set cos1_sqrt_part_w = [ &
&   "3.9847929621330180E-04", "2.7756772944468894E-03", "9.9787382004175255E-03", "3.2124745520119027E-02", "4.3277149578179819E-01", &
& ]
#:set cos1_x = [ &
&   ["-1.0000000000000000E+00", "-9.9359509346774344E-01",], &
&   ["-9.9359509346774344E-01", "-9.7462651083709551E-01",], &
&   ["-9.7462651083709551E-01", "-9.4382320410084841E-01",], &
&   ["-9.4382320410084841E-01", "-9.0236892706218241E-01",], &
&   ["-9.0236892706218241E-01", "-8.5185674433986724E-01",], &
&   ["-8.5185674433986724E-01", "-7.9422781078836324E-01",], &
&   ["-7.9422781078836324E-01", "-7.3169677400537603E-01",], &
&   ["-7.3169677400537603E-01", "-6.6666666666666663E-01",], &
&   ["-6.6666666666666663E-01", "-6.0163655932795723E-01",], &
&   ["-6.0163655932795723E-01", "-5.3910552254497002E-01",], &
&   ["-5.3910552254497002E-01", "-4.8147658899346590E-01",], &
&   ["-4.8147658899346590E-01", "-4.3096440627115074E-01",], &
&   ["-4.3096440627115074E-01", "-3.8951012923248490E-01",], &
&   ["-3.8951012923248490E-01", "-3.5870682249623770E-01",], &
&   ["-3.5870682249623770E-01", "-3.3973823986558982E-01",], &
&   ["-3.3973823986558982E-01", "-3.3333333333333331E-01",], &
& ]
#:set cos1_w = [ &
&   ["-4.4315184208683009E-04", "-3.9094541810967580E-03", "-1.7299892032203112E-02", "-8.0199584460538112E-02", "4.3363400523265505E-01",], &
&   ["-6.7209594517350516E-04", "-4.8231089142143167E-03", "-1.8667179427405704E-02", "-8.1108971691447651E-02", "4.3340719476770234E-01",], &
&   ["-6.9438949152630860E-04", "-4.9120386001966637E-03", "-1.8800127486730048E-02", "-8.1197256191251371E-02", "4.3338522222407222E-01",], &
&   ["-7.3073571985800495E-04", "-5.0518062579049021E-03", "-1.9001614978978648E-02", "-8.1326311537757254E-02", "4.3335423304438825E-01",], &
&   ["-7.7196547135679008E-04", "-5.2028791279672632E-03", "-1.9209176965038700E-02", "-8.1453042756594596E-02", "4.3332521887221997E-01",], &
&   ["-8.1593001974620747E-04", "-5.3541683631345548E-03", "-1.9404434950043736E-02", "-8.1565061560770341E-02", "4.3330111604914950E-01",], &
&   ["-8.6056962276476309E-04", "-5.4963961845812927E-03", "-1.9574432596623240E-02", "-8.1655401716853246E-02", "4.3328310615379090E-01",], &
&   ["-9.0416322778480223E-04", "-5.6232572143481386E-03", "-1.9712941110903281E-02", "-8.1722645890353871E-02", "4.3327085781463626E-01",], &
&   ["-9.4513459033710042E-04", "-5.7308144625669716E-03", "-1.9818864573377594E-02", "-8.1769025248555283E-02", "4.3326323963130026E-01",], &
&   ["-9.8188418043559608E-04", "-5.8169872449167380E-03", "-1.9894634120332454E-02", "-8.1798632710941177E-02", "4.3325890161846531E-01",], &
&   ["-1.0126835747521559E-03", "-5.8811858673820331E-03", "-1.9944779226966546E-02", "-8.1816026567215941E-02", "4.3325664116607976E-01",], &
&   ["-1.0342548380734042E-03", "-5.9214401525560980E-03", "-1.9972916636490534E-02", "-8.1824756601987431E-02", "4.3325562689983299E-01",], &
&   ["-1.0438491065591785E-03", "-5.9385540898855603E-03", "-1.9984334452358841E-02", "-8.1828134111609663E-02", "4.3325525305592494E-01",], &
&   ["-1.0017184016404004E-03", "-5.8780767289679011E-03", "-1.9951962387784239E-02", "-8.1820483856424223E-02", "4.3325592565234505E-01",], &
&   ["-1.0718142002572335E-03", "-5.9834010712534903E-03", "-2.0011267851204748E-02", "-8.1835315588003818E-02", "4.3325453554532845E-01",], &
&   ["1.5326464766736131E-02", "1.6090358221566393E-02", "-8.8688708429932525E-03", "-7.9335595098382547E-02", "4.3346483034802730E-01",], &
& ]
#:set cos2_x = [ &
&   ["-3.3333333333333331E-01", "-3.2692842680107681E-01",], &
&   ["-3.2692842680107681E-01", "-3.0795984417042893E-01",], &
&   ["-3.0795984417042893E-01", "-2.7715653743418178E-01",], &
&   ["-2.7715653743418178E-01", "-2.3570226039551581E-01",], &
&   ["-2.3570226039551581E-01", "-1.8519007767320064E-01",], &
&   ["-1.8519007767320064E-01", "-1.2756114412169658E-01",], &
&   ["-1.2756114412169658E-01", "-6.5030107338709398E-02",], &
&   ["-6.5030107338709398E-02", "2.0410779985789219E-17",], &
&   ["2.0410779985789219E-17", "6.5030107338709439E-02",], &
&   ["6.5030107338709439E-02", "1.2756114412169661E-01",], &
&   ["1.2756114412169661E-01", "1.8519007767320075E-01",], &
&   ["1.8519007767320075E-01", "2.3570226039551587E-01",], &
&   ["2.3570226039551587E-01", "2.7715653743418173E-01",], &
&   ["2.7715653743418173E-01", "3.0795984417042893E-01",], &
&   ["3.0795984417042893E-01", "3.2692842680107681E-01",], &
&   ["3.2692842680107681E-01", "3.3333333333333331E-01",], &
& ]
#:set cos2_w = [ &
&   ["1.8395297678319651E+00", "2.4969876526932113E+00", "1.1810621799269616E+00", "4.3782239759124364E-01", "8.8843888967801599E-01",], &
&   ["-6.4219102740212516E-02", "-1.6824891579088744E-02", "-6.3686283568075194E-02", "1.6389090333449385E-01", "8.6583268044700412E-01",], &
&   ["-4.9763272376835199E-02", "9.0919152465994760E-04", "-5.5521049894678313E-02", "1.6556317981823954E-01", "8.6596122070609338E-01",], &
&   ["-4.6094553636555020E-02", "4.8945805287414559E-03", "-5.3902260580985510E-02", "1.6585450714067851E-01", "8.6598081648821434E-01",], &
&   ["-3.7309724352700920E-02", "1.3448218908737524E-02", "-5.0777577383049576E-02", "1.6636209820489792E-01", "8.6601175588449131E-01",], &
&   ["-2.9244155862615234E-02", "1.9663661187645474E-02", "-4.8976464462506884E-02", "1.6659469865312601E-01", "8.6602305013491243E-01",], &
&   ["-2.2538924208554495E-02", "2.3225574884457714E-02", "-4.8259111965844877E-02", "1.6665956084519626E-01", "8.6602526932213775E-01",], &
&   ["-1.7378154117068938E-02", "2.4598988071184963E-02", "-4.8114274659517765E-02", "1.6666665852319054E-01", "8.6602540378443871E-01",], &
&   ["-1.3553620715464412E-02", "2.4550226186394838E-02", "-4.8108454517897879E-02", "1.6666662550838260E-01", "8.6602540378443871E-01",], &
&   ["-1.0801050651436708E-02", "2.3742909626378202E-02", "-4.8017195464303768E-02", "1.6666191863808810E-01", "8.6602549673729001E-01",], &
&   ["-8.8830094567599049E-03", "2.2666041462379303E-02", "-4.7790650512000508E-02", "1.6664071652851559E-01", "8.6602624235978243E-01",], &
&   ["-7.6571258517552383E-03", "2.1686329029767897E-02", "-4.7498328812079382E-02", "1.6660207226608903E-01", "8.6602815407602185E-01",], &
&   ["-7.0255782716738529E-03", "2.1073814871776793E-02", "-4.7276147469309776E-02", "1.6656633375337848E-01", "8.6603030570492434E-01",], &
&   ["-7.8295972930313568E-03", "2.2069087892753036E-02", "-4.7734535263745798E-02", "1.6665954892510748E-01", "8.6602323680422966E-01",], &
&   ["-6.0628525198831683E-03", "1.9996332933739820E-02", "-4.6823085774891686E-02", "1.6648151341780490E-01", "8.6603627073160505E-01",], &
&   ["-4.0030366295225345E-01", "5.4061321716984034E-01", "-3.0463266768503361E-01", "2.2322162946609631E-01", "8.6135347150045749E-01",], &
& ]
#:set cos3_x = [ &
&   ["3.3333333333333331E-01", "3.3973823986558982E-01",], &
&   ["3.3973823986558982E-01", "3.5870682249623770E-01",], &
&   ["3.5870682249623770E-01", "3.8951012923248485E-01",], &
&   ["3.8951012923248485E-01", "4.3096440627115085E-01",], &
&   ["4.3096440627115085E-01", "4.8147658899346601E-01",], &
&   ["4.8147658899346601E-01", "5.3910552254497002E-01",], &
&   ["5.3910552254497002E-01", "6.0163655932795723E-01",], &
&   ["6.0163655932795723E-01", "6.6666666666666663E-01",], &
&   ["6.6666666666666663E-01", "7.3169677400537603E-01",], &
&   ["7.3169677400537603E-01", "7.9422781078836324E-01",], &
&   ["7.9422781078836324E-01", "8.5185674433986736E-01",], &
&   ["8.5185674433986736E-01", "9.0236892706218252E-01",], &
&   ["9.0236892706218252E-01", "9.4382320410084830E-01",], &
&   ["9.4382320410084830E-01", "9.7462651083709551E-01",], &
&   ["9.7462651083709551E-01", "9.9359509346774344E-01",], &
&   ["9.9359509346774344E-01", "1.0000000000000000E+00",], &
& ]
#:set cos3_w = [ &
&   ["1.6379208768376641E-01", "-2.0862984816574473E-01", "6.8575486295604088E-02", "1.4059415588099458E-01", "8.6821398812197281E-01",], &
&   ["-5.5312275070757595E-03", "1.9304365630613312E-02", "-4.6485249487182752E-02", "1.6640818918214420E-01", "8.6604223993079610E-01",], &
&   ["-4.5825469128735318E-03", "1.7912336845879766E-02", "-4.5718940573365029E-02", "1.6622061898984430E-01", "8.6605946386505817E-01",], &
&   ["-4.6826642429021936E-03", "1.8036331382216803E-02", "-4.5773192000013029E-02", "1.6623010784523523E-01", "8.6605897577508117E-01",], &
&   ["-4.2467388700637779E-03", "1.7294617543158398E-02", "-4.5299933326708605E-02", "1.6609590061597670E-01", "8.6607324737316826E-01",], &
&   ["-3.7459810728414315E-03", "1.6349245532535854E-02", "-4.4630573918272118E-02", "1.6588524374307317E-01", "8.6609811052895269E-01",], &
&   ["-3.2457641222267664E-03", "1.5289226469940125E-02", "-4.3787880766398710E-02", "1.6558738449049160E-01", "8.6613760632434089E-01",], &
&   ["-2.7949018536916137E-03", "1.4216814771902080E-02", "-4.2830794067372849E-02", "1.6520754403172189E-01", "8.6619416855659492E-01",], &
&   ["-2.4092171779598621E-03", "1.3193578079087663E-02", "-4.1812202147107638E-02", "1.6475663164498128E-01", "8.6626906590931441E-01",], &
&   ["-2.0916928154405289E-03", "1.2262952976195925E-02", "-4.0788896583406904E-02", "1.6425630369540861E-01", "8.6636084343270781E-01",], &
&   ["-1.8379946536255555E-03", "1.1450956478253553E-02", "-3.9814044507477366E-02", "1.6373600002226296E-01", "8.6646500847467234E-01",], &
&   ["-1.6411680086988569E-03", "1.0771647280958661E-02", "-3.8934831663961562E-02", "1.6323023211706608E-01", "8.6657411594354949E-01",], &
&   ["-1.4942063958708338E-03", "1.0231937611134381E-02", "-3.8191725159456937E-02", "1.6277559179429160E-01", "8.6667840280718889E-01",], &
&   ["-1.3906692428650904E-03", "9.8328410206914851E-03", "-3.7615094407736367E-02", "1.6240546423590968E-01", "8.6676745850378079E-01",], &
&   ["-1.3397948995835937E-03", "9.6290578242373415E-03", "-3.7309249772141541E-02", "1.6220161737615180E-01", "8.6681836947325763E-01",], &
&   ["-8.6144424095023974E-04", "7.7197966442029160E-03", "-3.4451604227318980E-02", "1.6030070662978621E-01", "8.6729254519428001E-01",], &
& ]
#:set cosh_x = [ &
&   ["0.0000000000000000E+00", "2.4076366639015911E-03",], &
&   ["2.4076366639015911E-03", "9.6073597983847847E-03",], &
&   ["9.6073597983847847E-03", "2.1529832133895588E-02",], &
&   ["2.1529832133895588E-02", "3.8060233744356631E-02",], &
&   ["3.8060233744356631E-02", "5.9039367825822531E-02",], &
&   ["5.9039367825822531E-02", "8.4265193848727327E-02",], &
&   ["8.4265193848727327E-02", "1.1349477331863150E-01",], &
&   ["1.1349477331863150E-01", "1.4644660940672627E-01",], &
&   ["1.4644660940672627E-01", "1.8280335791817731E-01",], &
&   ["1.8280335791817731E-01", "2.2221488349019902E-01",], &
&   ["2.2221488349019902E-01", "2.6430163158700115E-01",], &
&   ["2.6430163158700115E-01", "3.0865828381745514E-01",], &
&   ["3.0865828381745514E-01", "3.5485766137276892E-01",], &
&   ["3.5485766137276892E-01", "4.0245483899193590E-01",], &
&   ["4.0245483899193590E-01", "4.5099142983521967E-01",], &
&   ["4.5099142983521967E-01", "5.0000000000000000E-01",], &
&   ["5.0000000000000000E-01", "5.4900857016478044E-01",], &
&   ["5.4900857016478044E-01", "5.9754516100806421E-01",], &
&   ["5.9754516100806421E-01", "6.4514233862723114E-01",], &
&   ["6.4514233862723114E-01", "6.9134171618254492E-01",], &
&   ["6.9134171618254492E-01", "7.3569836841299896E-01",], &
&   ["7.3569836841299896E-01", "7.7778511650980109E-01",], &
&   ["7.7778511650980109E-01", "8.1719664208182274E-01",], &
&   ["8.1719664208182274E-01", "8.5355339059327373E-01",], &
&   ["8.5355339059327373E-01", "8.8650522668136844E-01",], &
&   ["8.8650522668136844E-01", "9.1573480615127267E-01",], &
&   ["9.1573480615127267E-01", "9.4096063217417747E-01",], &
&   ["9.4096063217417747E-01", "9.6193976625564337E-01",], &
&   ["9.6193976625564337E-01", "9.7847016786610441E-01",], &
&   ["9.7847016786610441E-01", "9.9039264020161522E-01",], &
&   ["9.9039264020161522E-01", "9.9759236333609846E-01",], &
&   ["9.9759236333609846E-01", "1.0000000000000000E+00",], &
& ]
#:set cosh_w = [ &
&   ["3.9414310840510931E+04", "-1.5388852511647804E+02", "-1.2859815450894346E-01", "-2.8077701725688989E-04", "0.0000000000000000E+00",], &
&   ["-8.3641322340995816E+02", "2.3499849315153956E+01", "-3.8510281590664380E-01", "-4.0837918473192632E-08", "-3.1222570124227493E-07",], &
&   ["3.3042631832369842E+01", "-1.1072288701167787E+00", "-1.0224191363117448E-01", "-1.6665362957681792E-03", "4.0034616360363394E-06",], &
&   ["-9.7570826743050212E+00", "1.5754046318485415E+00", "-1.6682379970183328E-01", "-9.2362215198896745E-04", "3.6846699415399257E-07",], &
&   ["-5.1902297034761025E-01", "3.2367382250429227E-01", "-1.0155111077598132E-01", "-2.4857493804947431E-03", "1.4897666037360817E-05",], &
&   ["-7.1524678834295152E-01", "3.4180595650838175E-01", "-1.0112509827606359E-01", "-2.5657365971070876E-03", "1.6787779919898087E-05",], &
&   ["-2.5835518118666168E-01", "1.9330141779281912E-01", "-8.2852487133687244E-02", "-3.5750188938701655E-03", "3.7907797264517630E-05",], &
&   ["-1.6181326644804547E-01", "1.4826445658004062E-01", "-7.4980020016418014E-02", "-4.1863499106907683E-03", "5.5707552284908250E-05",], &
&   ["-9.2757808369856934E-02", "1.0804637948994879E-01", "-6.6166736894983397E-02", "-5.0476386164712266E-03", "8.7379039241076701E-05",], &
&   ["-6.0043181007770861E-02", "8.4046424102679818E-02", "-5.9552570148258807E-02", "-5.8592169039467304E-03", "1.2478955965987616E-04",], &
&   ["-4.0000286863080305E-02", "6.6228068661726661E-02", "-5.3602283495021205E-02", "-6.7438466066535863E-03", "1.7419247316973775E-04",], &
&   ["-2.7913717487981524E-02", "5.3431249121508345E-02", "-4.8515053318852926E-02", "-7.6438205309015926E-03", "2.3397330087251313E-04",], &
&   ["-2.0073233616405655E-02", "4.3737449694731825E-02", "-4.4015898567341005E-02", "-8.5728755300392995E-03", "3.0599103682778055E-04",], &
&   ["-1.4845627311271425E-02", "3.6303365639301574E-02", "-4.0048105511851506E-02", "-9.5148839785723915E-03", "3.8992905746778434E-04",], &
&   ["-1.1237876496340770E-02", "3.0482762843817138E-02", "-3.6524157159683365E-02", "-1.0463757117722449E-02", "4.8580676743894809E-04",], &
&   ["-8.6866288461088150E-03", "2.5868392990044065E-02", "-3.3392698453104178E-02", "-1.1408779613231839E-02", "5.9281386402375378E-04",], &
&   ["-6.8421146442684865E-03", "2.2168206621037911E-02", "-3.0607896808135568E-02", "-1.2340703654686758E-02", "7.0981663201980633E-04",], &
&   ["-5.4839381124693600E-03", "1.9175245819588488E-02", "-2.8133684909586801E-02", "-1.3250093751109023E-02", "8.3520429447937240E-04",], &
&   ["-4.4677773530490839E-03", "1.6736832073753413E-02", "-2.5938801979818904E-02", "-1.4128429717391455E-02", "9.6705094930925176E-04",], &
&   ["-3.6969666154476589E-03", "1.4738773862969248E-02", "-2.3996127555763004E-02", "-1.4968101871215925E-02", "1.1031801031560512E-03",], &
&   ["-3.1052006831439492E-03", "1.3093986697037478E-02", "-2.2281471570139003E-02", "-1.5762682878720981E-02", "1.2412843748124966E-03",], &
&   ["-2.6461051608722645E-03", "1.1735115741421137E-02", "-2.0772991856746890E-02", "-1.6507026069114611E-02", "1.3790349359962340E-03",], &
&   ["-2.2866367311442821E-03", "1.0609289545529912E-02", "-1.9450636768538431E-02", "-1.7197388981810093E-02", "1.5142028014753488E-03",], &
&   ["-2.0027965057111716E-03", "9.6742603197522078E-03", "-1.8295528060171599E-02", "-1.7831628925705879E-02", "1.6447993085947463E-03",], &
&   ["-1.7767299395166965E-03", "8.8953139496187258E-03", "-1.7289050825310941E-02", "-1.8409608434520927E-02", "1.7692643732821591E-03",], &
&   ["-1.5945395350942650E-03", "8.2420862361801493E-03", "-1.6410830700707413E-02", "-1.8934330439947859E-02", "1.8868237397523147E-03",], &
&   ["-1.4446222133343795E-03", "7.6854729776168525E-03", "-1.5635974214412648E-02", "-1.9413670147778013E-02", "1.9980060889773230E-03",], &
&   ["-1.3133633086232143E-03", "7.1832781430170821E-03", "-1.4915630924615536E-02", "-1.9872784251906896E-02", "2.1077127577039710E-03",], &
&   ["-1.1886353202684085E-03", "6.6941171010129518E-03", "-1.4196484450927648E-02", "-2.0342518926269412E-02", "2.2227337516311065E-03",], &
&   ["-9.5717334017484746E-04", "5.7755423510707973E-03", "-1.2829696355657479E-02", "-2.1246227043857705E-02", "2.4467664650353678E-03",], &
&   ["-1.1038507390434989E-03", "6.3468344495524309E-03", "-1.3663919081264089E-02", "-2.0704952589541407E-02", "2.3151000209279491E-03",], &
&   ["4.8313451779710657E-02", "-1.9108684889686198E-01", "2.8213364748638348E-01", "-2.1766824568662371E-01", "5.1497207377905196E-02",], &
& ]
#:def p4(w, nest)
${" "*nest}$call p4_1((${w[0]}$_RK / (${w[2]}$_RK)), &
${" "*nest}$  &       (${w[1]}$_RK / (${w[3]}$_RK)), &
${" "*nest}$  &       ${w[2]}$_RK, &
${" "*nest}$  &       ${w[3]}$_RK, &
${" "*nest}$  &       ${w[4]}$_RK, &
${" "*nest}$  &       x, res)
#:enddef
#:def coef(w, nest)
${" "*nest}$a = ${cos1_sqrt_part_w[0]}$ * e + (${w[0]}$_RK)
${" "*nest}$b = ${cos1_sqrt_part_w[1]}$ * e + (${w[1]}$_RK)
${" "*nest}$c = ${cos1_sqrt_part_w[2]}$ * e + (${w[2]}$_RK)
${" "*nest}$d = ${cos1_sqrt_part_w[3]}$ * e + (${w[3]}$_RK)
${" "*nest}$e = ${cos1_sqrt_part_w[4]}$ * e + (${w[4]}$_RK)
#:enddef
#:def binary_search(x, w, f, nest)
#:if len(x)==2
${" "*nest}$if (x < ${x[0][1]}$_RK) then
${f(w[0], nest+2)}$
${" "*nest}$else
${f(w[1], nest+2)}$
${" "*nest}$endif
#:else
${" "*nest}$if (x < ${x[len(x)//2][0]}$_RK) then
${binary_search(x[:len(x)//2], w[:len(x)//2], f, nest+2)}$
${" "*nest}$else
${binary_search(x[len(x)//2:], w[len(x)//2:], f, nest+2)}$
${" "*nest}$endif
#:endif
#:enddef
  pure elemental function cos_acos(x) result(res)
    real(RK), intent(in) :: x
    real(RK)             :: res, yy, df
    if (x < -1.0000000000000000E+00_RK) then
      res = 1.0000000000000000E+00_RK / 2.0000000000000000E+00_RK
      return
    elseif (x < -0.3333333333333333E+00_RK) then
      block
        real(RK) :: a, b, c, d, e
        e = sqrt(x + ONE)
${binary_search(cos1_x, cos1_w, coef, 8)}$
        call p4_0(a, b, c, d, e, x, res)
      end block
    elseif (x < 0.3333333333333333E+00) then
${binary_search(cos2_x, cos2_w, p4, 6)}$
    elseif (x <= 1.0000000000000000E+00_RK) then
${binary_search(cos3_x, cos3_w, p4, 6)}$
    else
      res = cosh_acosh(ONE / x)
      return
    end if
    yy = res * res
    df = 12.0_RK * yy - 3.0_RK
    if (ABS(df) < 1E-18_RK) return
    df = ((4.0_RK * yy - 3.0_RK) * res - x) / df
    res = res - df
  end function cos_acos
!
  pure elemental function cosh_acosh(x) result(res)
    real(RK), intent(in) :: x
    real(RK)             :: res, yy, df
    if (x < ZERO) then
      res = ONE
      return
    elseif (x > ONE) then
      res = cos_acos(ONE / x)
      return
    else
${binary_search(cosh_x, cosh_w, p4, 6)}$
    end if
    yy = (HALF * x)**(1 / 3)
    res = res + HALF * (yy + ONE / yy)
    yy = res * res
    df = 12.0_RK * yy - 3.0_RK
    if (ABS(df) < 1E-18_RK) return
    df = ((4.0_RK * yy - 3.0_RK) * res - ONE / x) / df
    res = res - df
  end function cosh_acosh
!
  pure elemental subroutine p4_0(a, b, c, d, e, x, res)
    real(RK), intent(in)    :: a, b, c, d, e, x
    real(RK), intent(inout) :: res
    real(RK)                :: xx
    xx = x * x
    res = a * xx * xx + b * x * xx + c * xx + d * x + e
  end subroutine p4_0
!
  pure elemental subroutine p4_1(a, b, c, d, e, x, res)
    real(RK), intent(in)    :: a, b, c, d, e, x
    real(RK), intent(inout) :: res
    real(RK)                :: xx
    xx = x * x
    res = c * xx * (a * xx + ONE) + d * x * (b * xx + ONE) + e
  end subroutine p4_1
!
